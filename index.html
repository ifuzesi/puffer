<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Pufferhatás szemléltetése - titrálással</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #lab { position: relative; width: 260px; height: 580px; }
  #drop {
    position: absolute; width: 10px; height: 10px; background: deepskyblue;
    border-radius: 50%; left: 128px; top: 260px; opacity: 0;
  }
  .fall { animation: fall 0.9s linear forwards; }
  @keyframes fall { 0%{opacity:1;top:260px;}100%{opacity:0;top:480px;} }
</style>
</head>

<body>

<h2>Pufferhatás szemléltetése - titrálással</h2>

<p><strong>A titrált folyadék:</strong></p>
<label><input type="radio" name="mode" value="viz" checked> víz + fenolftalein indikátor</label><br>
<label><input type="radio" name="mode" value="puffer"> puffer + fenolftalein indikátor</label>

<br><br>

<p><strong>Mérőoldat:</strong> 0,1 mol/dm³ koncentrációjú NaOH-oldat</p>

<button onclick="csepp()">+1 csepp</button>
<button onclick="reset()">Újrakezdés</button>

<p id="counter">Cseppek száma: 0</p>

<div id="lab">
  <div id="drop"></div>

  <svg width="260" height="580" xmlns="http://www.w3.org/2000/svg">

    <!-- BÜRETTA -->
    <rect x="120" y="10" width="20" height="250"
          fill="none" stroke="black" stroke-width="2"/>

    <!-- BÜRETTA SZINT -->
    <rect id="burettaSzint" x="120" y="10" width="20" height="250"
          fill="rgba(150,180,255,0.4)" />

    <!-- SKÁLA -->
    <g stroke-width="1.4">
      <line x1="120" y1="40"  x2="133" y2="40"/>
      <line x1="120" y1="70"  x2="133" y2="70"/>
      <line x1="120" y1="100" x2="133" y2="100"/>
      <line x1="120" y1="130" x2="133" y2="130"/>
      <line x1="120" y1="160" x2="133" y2="160"/>
      <line x1="120" y1="190" x2="133" y2="190"/>
      <line x1="120" y1="220" x2="133" y2="220"/>
      <line x1="120" y1="250" x2="133" y2="250"/>
    </g>

    <!-- CSAP ÉS CSŐ -->
    <rect x="118" y="260" width="24" height="12"
          fill="none" stroke="black" stroke-width="2"/>
    <rect x="128" y="272" width="4" height="60"
          fill="none" stroke="black" stroke-width="1.5"/>

    <!-- POHÁR -->
    <line x1="90" y1="360" x2="90" y2="480" stroke="black" stroke-width="6"/>
    <line x1="170" y1="360" x2="170" y2="480" stroke="black" stroke-width="6"/>
    <line x1="90" y1="480" x2="170" y2="480" stroke="black" stroke-width="6"/>
    <line x1="90" y1="360" x2="170" y2="360" stroke="black" stroke-width="3"/>

    <!-- FOLYADÉK A POHÁRBAN -->
    <rect id="poharSzint" x="90" y="440" width="80" height="40"
          fill="rgba(150,180,255,0.45)"/>

  </svg>
</div>

<script>
let burettaMagassag = 250;
let burettaY = 10;

let poharY = 440;
let poharH = 40;

let drops = 0;

function csepp() {
  const mode = document.querySelector('input[name="mode"]:checked').value;

  const drop = document.getElementById("drop");
  drop.classList.remove("fall");
  void drop.offsetWidth;
  drop.classList.add("fall");

  drops++;
  document.getElementById("counter").innerText = "Cseppek száma: " + drops;

  if (burettaMagassag > 20) {
    burettaMagassag -= 5;
    burettaY += 5;
    document.getElementById("burettaSzint").setAttribute("y", burettaY);
    document.getElementById("burettaSzint").setAttribute("height", burettaMagassag);
  }

  if (poharY > 380) {
    poharY -= 1;
    poharH += 1;
    const p = document.getElementById("poharSzint");
    p.setAttribute("y", poharY);
    p.setAttribute("height", poharH);

    if ((mode === "viz"  && drops >= 2) ||
        (mode === "puffer" && drops >= 30)) {
      p.setAttribute("fill", "rgba(255,105,180,0.45)");
    }
  }
}

function reset() {
  drops = 0;
  document.getElementById("counter").innerText = "Cseppek száma: 0";

  burettaMagassag = 250;
  burettaY = 10;
  document.getElementById("burettaSzint").setAttribute("y", burettaY);
  document.getElementById("burettaSzint").setAttribute("height", burettaMagassag);

  poharY = 440;
  poharH = 40;
  const p = document.getElementById("poharSzint");
  p.setAttribute("y", poharY);
  p.setAttribute("height", poharH);
  p.setAttribute("fill", "rgba(150,180,255,0.45)");
}
</script>

</body>
</html>